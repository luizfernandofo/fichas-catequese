<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ficha de Inscrição de Primeira Eucaristia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/imask/6.4.3/imask.min.js"></script>
  <script src="utils.js"></script>
  <link rel="stylesheet" href="index.css">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-xl p-8">
    <h1 class="text-center font-bold text-lg">ARQUIDIOCESE DE GOIÂNIA – PARÓQUIA SANT’ANA</h1>
    <h3 class="text-center text-blue-600 font-bold mt-2">FICHA DE INSCRIÇÃO DE PRIMEIRA EUCARISTIA</h3>

    <p class="mt-4 font-semibold">OBSERVAÇÃO: <span class="font-normal">ao preencher a ficha, não abreviar nenhum nome.</span></p>

    <form id="form-primeira-eucaristia" class="mt-6 space-y-4 print:space-y-2">
      <div>
        <label class="block font-semibold">Nome do Catequizando:</label>
        <input type="text" name="nome_catequizando" class="w-full border rounded p-2" />
      </div>

      <hr>

      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">Data Nasc.:</label>
          <input type="date" name="data_nascimento" class="w-full border rounded p-2" />
        </div>
        <div>
          <label class="block font-semibold">Naturalidade:</label>
          <input type="text" name="naturalidade" class="w-full border rounded p-2" />
        </div>
      </div>

      <div>
        <label class="block font-semibold">Nacionalidade:</label>
        <input type="text" name="nacionalidade" class="w-full border rounded p-2" />
      </div>

      <div class="grid md:grid-cols-3 gap-4">
        <div>
          <label class="block font-semibold">Ano Escolar:</label>
          <input type="text" name="ano_escolar" class="w-full border rounded p-2" />
        </div>
        <div>
          <label class="block font-semibold">Horário Escolar:</label>
          <select name="horario" class="w-full border rounded p-2">
            <option value="Matutino">Matutino</option>
            <option value="Vespertino">Vespertino</option>
            <option value="Integral">Integral</option>
          </select>
        </div>
        <div>
          <label class="block font-semibold">Escola:</label>
          <input type="text" name="escola" class="w-full border rounded p-2" />
        </div>
      </div>

      <div>
        <label class="block font-semibold">Endereço Completo:</label>
        <input type="text" name="endereco" class="w-full border rounded p-2" />
      </div>

      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">CPF do catequizando:</label>
          <input type="text" inputmode="numeric" id="cpf" name="cpf" class="w-full border rounded p-2" />
        </div>
        <div>
          <label class="block font-semibold">Celular:</label>
          <input type="text" inputmode="numeric" id="celular" name="celular" class="w-full border rounded p-2" />
        </div>
      </div>

      <hr>

      <div class="grid grid-cols-2 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">É batizado?</label>
          <select name="batizado" class="w-full border rounded p-2">
            <option value="Sim">Sim</option>
            <option value="Não">Não</option>
          </select>
        </div>
        <div>
          <label class="block font-semibold">Paróquia do Batismo:</label>
          <input type="text" name="paroquia_batismo" class="w-full border rounded p-2" />
        </div>
      </div>

      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">Data do Batismo:</label>
          <input type="date" name="data_batismo" class="w-full border rounded p-2" />
        </div>
      </div>

      <div>
        <label class="block font-semibold">Participa das Missas Dominicais em qual horário e Igreja?</label>
        <input type="text" name="missas_dominicais" class="w-full border rounded p-2" placeholder="Ex: Às 18h00, Igreja Santo Antônio" />
      </div>

      <hr>

      <div>
        <label class="block font-semibold">Nome completo do Pai:</label>
        <input type="text" name="nome_pai" class="w-full border rounded p-2" />
      </div>

      <div class="grid md:grid-cols-2 gap-4">
        <input type="text" inputmode="numeric" id="cel_pai" name="cel_pai" placeholder="Cel" class="border rounded p-2" />
        <input type="email" name="email_pai" placeholder="E-mail" class="border rounded p-2" />
      </div>

      <div>
        <label class="block font-semibold">Nome completo da Mãe:</label>
        <input type="text" name="nome_mae" class="w-full border rounded p-2" />
      </div>

      <div class="grid md:grid-cols-2 gap-4">
        <input type="text" inputmode="numeric" id="cel_mae" name="cel_mae" placeholder="Cel" class="border rounded p-2" />
        <input type="email" name="email_mae" placeholder="E-mail" class="border rounded p-2" />
      </div>

      <hr>

      <div>
        <label class="block font-semibold">Igreja onde acontece os encontros:</label>
        <input type="text" name="igreja" class="w-full border rounded p-2" />
      </div>

      <div class="grid grid-cols-2 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">Dia da semana:</label>
          <select name="dia_semana" class="w-full border rounded p-2">
            <option>Domingo</option>
            <option>Segunda-feira</option>
            <option>Terça-feira</option>
            <option>Quarta-feira</option>
            <option>Quinta-feira</option>
            <option>Sexta-feira</option>
            <option>Sábado</option>
          </select>
        </div>
        <div>
          <label class="block font-semibold">Horário:</label>
          <input type="text" id="horario_turma" name="horario_turma" placeholder="00:00" inputmode="numeric" class="w-full border rounded p-2" />
        </div>
      </div>

      <div>
        <label class="block font-semibold">Catequista(s):</label>
        <input type="text" name="catequista" class="w-full border rounded p-2" />
      </div>

      <div>
        <label class="block font-semibold">Padrinho:</label>
        <input type="text" name="padrinho" class="w-full border rounded p-2" />
      </div>

      <div>
        <label class="block font-semibold">Madrinha:</label>
        <input type="text" name="madrinha" class="w-full border rounded p-2" />
      </div>

      <div class="text-center mt-6 space-y-4">
        <button type="button" id="btn-pdf" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg mr-4">Gerar PDF</button>
        <a href="index.html" class="inline-block bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg">Voltar ao Início</a>
      </div>

      <!-- Disclaimer -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
        <p class="text-yellow-800 text-xs text-center">
          <strong>⚠️ DISCLAIMER:</strong> Este site foi desenvolvido de forma independente por um membro da comunidade paroquial. 
          Não é um site oficial da Arquidiocese de Goiânia nem da Paróquia Sant'Ana. 
          É uma ferramenta pessoal criada para facilitar o preenchimento das fichas de inscrição.
        </p>
      </div>
    </form>
  </div>
  <!-- Versão para impressão -->
  <div id="print-version">
    <h1 class="text-center font-bold text-lg">ARQUIDIOCESE DE GOIÂNIA – PARÓQUIA SANT'ANA</h1>
    <h2 class="text-center text-blue-600 font-bold mt-2">FICHA DE INSCRIÇÃO DE PRIMEIRA EUCARISTIA</h2>

    <p><strong>Nome:</strong> <span id="p_nome"></span></p>
    <p><strong>Data Nasc.:</strong> <span id="p_data_nasc"></span> | <strong>Naturalidade:</strong> <span id="p_naturalidade"></span> | <strong>Nacionalidade:</strong> <span id="p_nacionalidade"></span></p>
    <p><strong>Ano Escolar:</strong> <span id="p_ano_escolar"></span> | <strong>Horário Escolar:</strong> <span id="p_horario_escolar"></span> | <strong>Escola:</strong> <span id="p_escola"></span></p>
    <p><strong>Endereço:</strong> <span id="p_endereco"></span></p>
    <p><strong>CPF:</strong> <span id="p_cpf"></span> | <strong>Celular:</strong> <span id="p_celular"></span></p>

    <p><strong>Batizado?</strong> <span id="p_batizado"></span> | <strong>Paróquia do Batismo:</strong> <span id="p_paroquia_batismo"></span> | <strong>Data do Batismo:</strong> <span id="p_data_batismo"></span></p>

    <p><strong>Missas Dominicais:</strong> <span id="p_missas_dominicais"></span></p>

    <p><strong>Pai:</strong> <span id="p_nome_pai"></span> | <strong>Cel:</strong> <span id="p_cel_pai"></span> | <strong>E-mail:</strong> <span id="p_email_pai"></span></p>
    <p><strong>Mãe:</strong> <span id="p_nome_mae"></span> | <strong>Cel:</strong> <span id="p_cel_mae"></span> | <strong>E-mail:</strong> <span id="p_email_mae"></span></p>

    <p><strong>Igreja:</strong> <span id="p_igreja"></span> | <strong>Dia:</strong> <span id="p_dia_semana"></span> | <strong>Horário:</strong> <span id="p_horario_turma"></span></p>

    <p><strong>Catequista(s):</strong> <span id="p_catequista"></span></p>
    <p><strong>Padrinho:</strong> <span id="p_padrinho"></span> | <strong>Madrinha:</strong> <span id="p_madrinha"></span></p>
  </div>


  <script>
    IMask(document.getElementById('cpf'), { mask: '000.000.000-00' });
    IMask(document.getElementById('celular'), { mask: '(00) 00000-0000' });
    IMask(document.getElementById('cel_pai'), { mask: '(00) 00000-0000' });
    IMask(document.getElementById('cel_mae'), { mask: '(00) 00000-0000' });
    IMask(document.getElementById('horario_turma'), { mask: '00:00' });

    // Função para formatar data no padrão brasileiro
    function formatDateToBR(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString + 'T00:00:00'); // Adiciona horário para evitar problemas de timezone
      const day = date.getDate().toString().padStart(2, '0');
      const month = (date.getMonth() + 1).toString().padStart(2, '0');
      const year = date.getFullYear();
      return `${day}/${month}/${year}`;
    }

    // Validação do CPF em tempo real
    document.getElementById('cpf').addEventListener('blur', function() {
      const cpfValue = this.value;
      if (cpfValue && !isValidCPF(cpfValue)) {
        this.classList.add('border-red-500');
        this.classList.remove('border-gray-300');
        // Adiciona mensagem de erro se não existir
        let errorMsg = this.parentNode.querySelector('.error-msg');
        if (!errorMsg) {
          errorMsg = document.createElement('span');
          errorMsg.className = 'error-msg text-red-500 text-sm';
          errorMsg.textContent = 'CPF inválido';
          this.parentNode.appendChild(errorMsg);
        }
      } else {
        this.classList.remove('border-red-500');
        this.classList.add('border-gray-300');
        // Remove mensagem de erro se existir
        const errorMsg = this.parentNode.querySelector('.error-msg');
        if (errorMsg) {
          errorMsg.remove();
        }
      }
    });

    document.getElementById("btn-pdf").addEventListener("click", () => {
      const form = document.getElementById("form-primeira-eucaristia");

      // Validar CPF antes de gerar PDF
      const cpfValue = form.cpf.value;
      if (cpfValue && !isValidCPF(cpfValue)) {
        alert('Por favor, insira um CPF válido antes de gerar o PDF.');
        form.cpf.focus();
        return;
      }

      document.getElementById("p_nome").innerText = form.nome_catequizando.value;
      document.getElementById("p_data_nasc").innerText = formatDateToBR(form.data_nascimento.value);
      document.getElementById("p_naturalidade").innerText = form.naturalidade.value;
      document.getElementById("p_nacionalidade").innerText = form.nacionalidade.value;
      document.getElementById("p_ano_escolar").innerText = form.ano_escolar.value;
      document.getElementById("p_horario_escolar").innerText = form.horario.value;
      document.getElementById("p_escola").innerText = form.escola.value;
      document.getElementById("p_endereco").innerText = form.endereco.value;
      document.getElementById("p_cpf").innerText = form.cpf.value;
      document.getElementById("p_celular").innerText = form.celular.value;
      document.getElementById("p_batizado").innerText = form.batizado.value;
      document.getElementById("p_paroquia_batismo").innerText = form.paroquia_batismo.value;
      document.getElementById("p_data_batismo").innerText = formatDateToBR(form.data_batismo.value);
      document.getElementById("p_missas_dominicais").innerText = form.missas_dominicais.value;
      document.getElementById("p_nome_pai").innerText = form.nome_pai.value;
      document.getElementById("p_cel_pai").innerText = form.cel_pai.value;
      document.getElementById("p_email_pai").innerText = form.email_pai.value;
      document.getElementById("p_nome_mae").innerText = form.nome_mae.value;
      document.getElementById("p_cel_mae").innerText = form.cel_mae.value;
      document.getElementById("p_email_mae").innerText = form.email_mae.value;
      document.getElementById("p_igreja").innerText = form.igreja.value;
      document.getElementById("p_dia_semana").innerText = form.dia_semana.value;
      document.getElementById("p_horario_turma").innerText = form.horario_turma.value;
      document.getElementById("p_catequista").innerText = form.catequista.value;
      document.getElementById("p_padrinho").innerText = form.padrinho.value;
      document.getElementById("p_madrinha").innerText = form.madrinha.value;

      // Configurações para remover headers e footers
      setTimeout(() => {
        window.print();
      }, 100);
    });

    // Função para preenchimento automático dos dados
    function preencherDadosAutomaticamente() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('preenchimento') === 'auto') {
        try {
          const dadosSalvos = localStorage.getItem('catequizando_selecionado');
          if (dadosSalvos) {
            const dados = JSON.parse(dadosSalvos);
            const form = document.getElementById('form-primeira-eucaristia');
            
            // Preencher todos os campos do formulário
            Object.keys(dados).forEach(campo => {
              const input = form.querySelector(`[name="${campo}"]`);
              if (input && dados[campo]) {
                input.value = dados[campo];
              }
            });

            // Mostrar notificação de sucesso
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            notification.innerHTML = `
              <div class="flex items-center space-x-2">
                <span>✅</span>
                <span>Dados preenchidos automaticamente!</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">✕</button>
              </div>
            `;
            document.body.appendChild(notification);

            // Remover notificação após 5 segundos
            setTimeout(() => {
              if (notification.parentElement) {
                notification.remove();
              }
            }, 5000);

            // Limpar dados do localStorage após uso
            localStorage.removeItem('catequizando_selecionado');
          }
        } catch (error) {
          console.error('Erro ao preencher dados automaticamente:', error);
        }
      }
    }

    // Executar preenchimento automático quando a página carregar
    document.addEventListener('DOMContentLoaded', preencherDadosAutomaticamente);
  </script>

  <script src="aviso-privacidade.js"></script>

</body>
</html>
